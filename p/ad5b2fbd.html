<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" type="image/png" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content="没有天生的大牛，更没有永远的菜鸟求知若饥 , 虚心若愚"><meta name="author" content="iceH"><meta name="keywords" content=""><title>红队攻防学习之权限提升 - iceH’s Blog</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/css/gundongtiao.css#%20%E6%BB%9A%E5%8A%A8%E6%9D%A1%E9%A2%9C%E8%89%B2.css"><link rel="stylesheet" href="/css/shubiao.css#%20%E9%BC%A0%E6%A0%87%E6%8C%87%E9%92%88.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><link rel="stylesheet" href="/css/valine.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"www.secice.cn",root:"/",version:"1.8.5",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},copy_btn:!0,image_zoom:{enable:!0},lazyload:{enable:!0,onlypost:!1},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}}}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="iceH’s Blog" type="application/atom+xml">
</head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>iceH's Blog</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="iconfont icon-books"></i> 博文</a><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档 </a><a class="dropdown-item" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类 </a><a class="dropdown-item" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></div></li><li class="nav-item"><a class="nav-link" href="/playlist/"><i class="iconfont icon-music"></i> 音乐</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner intro-2" id="background" parallax="true" style="background:url(/img/background1.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="红队攻防学习之权限提升"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2020-12-28 15:44" pubdate>2020年12月28日 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 3.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 64 分钟</span></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">红队攻防学习之权限提升</h1><div class="markdown-body"><h1 id="六、权限提升"><a href="#六、权限提升" class="headerlink" title="六、权限提升"></a>六、权限提升</h1><h2 id="6-1-操作系统提权"><a href="#6-1-操作系统提权" class="headerlink" title="6.1 操作系统提权"></a>6.1 操作系统提权</h2><h3 id="6-1-1-Linux"><a href="#6-1-1-Linux" class="headerlink" title="6.1.1 Linux"></a>6.1.1 Linux</h3><h4 id="6-1-1-1-Linux提权-依赖exp"><a href="#6-1-1-1-Linux提权-依赖exp" class="headerlink" title="6.1.1.1 Linux提权-依赖exp"></a>6.1.1.1 Linux提权-依赖exp</h4><p><strong>exp注：</strong></p><pre><code class="hljs subunit">CVE<span class="hljs-string">-2017</span><span class="hljs-string">-1000367</span> [Sudo] (Sudo 1.8.6p7 - 1.8.20)
CVE<span class="hljs-string">-2017</span><span class="hljs-string">-1000112</span> [a memory corruption due to UFO to non-UFO path switch]
CVE<span class="hljs-string">-2017</span><span class="hljs-string">-7494</span> [Samba Remote execution] (Samba 3.5.0<span class="hljs-string">-4</span>.6.4/4.5.10/4.4.14)
CVE<span class="hljs-string">-2017</span><span class="hljs-string">-7308</span> [a signedness issue in AF_PACKET sockets] (Linux kernel through 4.10.6)
CVE<span class="hljs-string">-2017</span><span class="hljs-string">-6074</span> [a double-free in DCCP protocol] (Linux kernel through 4.9.11)
CVE<span class="hljs-string">-2017</span><span class="hljs-string">-5123</span> [&#x27;waitid()&#x27;] (Kernel 4.14.0-rc4+)
CVE<span class="hljs-string">-2016</span><span class="hljs-string">-9793</span> [a signedness issue with SO_SNDBUFFORCE and SO_RCVBUFFORCE socket options]  (Linux kernel before 4.8.14)
CVE<span class="hljs-string">-2016</span><span class="hljs-string">-5195</span> [Dirty cow] (Linux kernel&gt;2.6.22 (released in 2007))
CVE<span class="hljs-string">-2016</span><span class="hljs-string">-2384</span> [a double-free in USB MIDI driver]  (Linux kernel before 4.5)
CVE<span class="hljs-string">-2016</span><span class="hljs-string">-0728</span> [pp_key] (3.8.0, 3.8.1, 3.8.2, 3.8.3, 3.8.4, 3.8.5, 3.8.6, 3.8.7, 3.8.8, 3.8.9, 3.9, 3.10, 3.11, 3.12, 3.13,3.4.0, 3.5.0, 3.6.0, 3.7.0, 3.8.0, 3.8.5, 3.8.6, 3.8.9, 3.9.0, 3.9.6,3.10.0, 3.10.6, 3.11.0, 3.12.0, 3.13.0, 3.13.1)
CVE<span class="hljs-string">-2015</span><span class="hljs-string">-7547</span> [glibc getaddrinfo] (before Glibc 2.9)
CVE<span class="hljs-string">-2015</span><span class="hljs-string">-1328</span> [overlayfs] (3.13, 3.16.0, 3.19.0)
CVE<span class="hljs-string">-2014</span><span class="hljs-string">-5284</span> [OSSEC] (2.8)
CVE<span class="hljs-string">-2014</span><span class="hljs-string">-4699</span> [ptrace] (before 3.15.4)
CVE<span class="hljs-string">-2014</span><span class="hljs-string">-4014</span> [Local Privilege Escalation] (before 3.14.8)
CVE<span class="hljs-string">-2014</span><span class="hljs-string">-3153</span> [futex]  (3.3.5 ,3.3.4 ,3.3.2 ,3.2.13 ,3.2.9 ,3.2.1 ,3.1.8 ,3.0.5 ,3.0.4 ,3.0.2 ,3.0.1 ,2.6.39 ,2.6.38 ,2.6.37 ,2.6.35 ,2.6.34 ,2.6.33 ,2.6.32 ,2.6.9 ,2.6.8,2.6.7 ,2.6.6 ,2.6.5 ,2.6.4 ,3.2.2 ,3.0.18 ,3.0 ,2.6.8.1)
CVE<span class="hljs-string">-2014</span><span class="hljs-string">-0196</span> [rawmodePTY] (2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36, 2.6.37, 2.6.38, 2.6.39, 3.14, 3.15)
CVE<span class="hljs-string">-2014</span><span class="hljs-string">-0038</span> [timeoutpwn] (3.4, 3.5, 3.6, 3.7, 3.8, 3.8.9, 3.9, 3.10, 3.11, 3.12, 3.13, 3.4.0, 3.5.0, 3.6.0, 3.7.0, 3.8.0, 3.8.5, 3.8.6, 3.8.9, 3.9.0, 3.9.6, 3.10.0, 3.10.6, 3.11.0, 3.12.0, 3.13.0, 3.13.1)
CVE<span class="hljs-string">-2013</span><span class="hljs-string">-2094</span> [perf_swevent] (3.0.0, 3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.1.0, 3.2, 3.3, 3.4.0, 3.4.1, 3.4.2, 3.4.3, 3.4.4,3.4.5, 3.4.6, 3.4.8, 3.4.9, 3.5, 3.6, 3.7, 3.8.0, 3.8.1, 3.8.2, 3.8.3,3.8.4, 3.8.5, 3.8.6, 3.8.7, 3.8.8, 3.8.9)
CVE<span class="hljs-string">-2013</span><span class="hljs-string">-1858</span> [clown-newuser] (3.3<span class="hljs-string">-3</span>.8)
CVE<span class="hljs-string">-2013</span><span class="hljs-string">-1763</span> [__sock_diag_rcv_msg] (before 3.8.3)
CVE<span class="hljs-string">-2013</span><span class="hljs-string">-0268</span> [msr]  (2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26,2.6.27, 2.6.27, 2.6.28,2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36, 2.6.37,2.6.38, 2.6.39, 3.0.0,3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.1.0, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7.0, 3.7.6)
CVE<span class="hljs-string">-2012</span><span class="hljs-string">-3524</span> [libdbus] (libdbus 1.5.x and earlier)
CVE<span class="hljs-string">-2012</span><span class="hljs-string">-0056</span> [memodipper] (2.6.39, 3.0.0, 3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.1.0)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-4347</span> [american-sign-language] ( 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9,2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21,2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-4258</span> [full-nelson] (2.6.31, 2.6.32, 2.6.35, 2.6.37)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-4073</span> [half_nelson] (2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9,2.6.10, 2.6.11, 2.6.12,2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21,2.6.22, 2.6.23, 2.6.24,2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33,2.6.34, 2.6.35, 2.6.36)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-3904</span> [rds] (2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-3437</span> [pktcdvd] (2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9,2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21,2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-3301</span> [ptrace_kmod2] (2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-3081</span> [video4linux] (2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12,2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-2959</span> [can_bcm] (2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-1146</span> [reiserfs] (2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34)
CVE<span class="hljs-string">-2010</span><span class="hljs-string">-0415</span> [do_pages_move] (2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31)
CVE<span class="hljs-string">-2009</span><span class="hljs-string">-3547</span> [pipe.c_32bit] (2.4.4, 2.4.5, 2.4.6, 2.4.7, 2.4.8, 2.4.9, 2.4.10, 2.4.11, 2.4.12, 2.4.13,2.4.14, 2.4.15, 2.4.16, 2.4.17, 2.4.18, 2.4.19, 2.4.20, 2.4.21, 2.4.22, 2.4.23, 2.4.24, 2.4.25,2.4.26, 2.4.27, 2.4.28,2.4.29, 2.4.30, 2.4.31, 2.4.32, 2.4.33, 2.4.34, 2.4.35, 2.4.36, 2.4.37,2.6.15, 2.6.16, 2.6.17,2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26,2.6.27, 2.6.28, 2.6.29,2.6.30, 2.6.31)
CVE<span class="hljs-string">-2009</span><span class="hljs-string">-2698</span> [udp_sendmsg_32bit] (2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13,  2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19)
CVE<span class="hljs-string">-2009</span><span class="hljs-string">-2692</span> [sock_sendpage] (2.4.4, 2.4.5, 2.4.6, 2.4.7, 2.4.8, 2.4.9, 2.4.10, 2.4.11, 2.4.12, 2.4.13,2.4.14, 2.4.15, 2.4.16,2.4.17, 2.4.18, 2.4.19, 2.4.20, 2.4.21, 2.4.22, 2.4.23, 2.4.24, 2.4.25, 2.4.26, 2.4.27, 2.4.28,2.4.29, 2.4.30, 2.4.31, 2.4.32, 2.4.33, 2.4.34, 2.4.35, 2.4.36, 2.4.37,2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12,2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30)
CVE<span class="hljs-string">-2009</span><span class="hljs-string">-2692</span> [sock_sendpage2] (2.4.4, 2.4.5, 2.4.6, 2.4.7, 2.4.8, 2.4.9, 2.4.10, 2.4.11, 2.4.12, 2.4.13, 2.4.14, 2.4.15, 2.4.16, 2.4.17, 2.4.18, 2.4.19, 2.4.20, 2.4.21, 2.4.22, 2.4.23, 2.4.24, 2.4.25,2.4.26, 2.4.27, 2.4.28,2.4.29, 2.4.30, 2.4.31, 2.4.32, 2.4.33, 2.4.34, 2.4.35, 2.4.36, 2.4.37, 2.6.0, 2.6.1, 2.6.2,2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15,2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24,2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30)
CVE<span class="hljs-string">-2009</span><span class="hljs-string">-1337</span> [exit_notify] (2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29)
CVE<span class="hljs-string">-2009</span><span class="hljs-string">-1185</span> [udev] (2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29)
CVE<span class="hljs-string">-2008</span><span class="hljs-string">-4210</span> [ftrex] (2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19,2.6.20, 2.6.21, 2.6.22)
CVE<span class="hljs-string">-2008</span><span class="hljs-string">-0600</span> [vmsplice2] (2.6.23, 2.6.24)
CVE<span class="hljs-string">-2008</span><span class="hljs-string">-0600</span> [vmsplice1] (2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.24.1)
CVE<span class="hljs-string">-2006</span><span class="hljs-string">-3626</span> [h00lyshit] (2.6.8, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16)
CVE<span class="hljs-string">-2006</span><span class="hljs-string">-2451</span> [raptor_prctl] (2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17)
CVE<span class="hljs-string">-2005</span><span class="hljs-string">-0736</span> [krad3] (2.6.5, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11)
CVE<span class="hljs-string">-2005</span><span class="hljs-string">-1263</span> [binfmt_elf.c] (Linux kernel 2.x.x to 2.2.27-rc2, 2.4.x to 2.4.31-pre1, and 2.6.x to 2.6.12-rc4)
CVE<span class="hljs-string">-2004</span><span class="hljs-string">-1235</span> [elflbl] (2.4.29)
CVE-N/A [caps_to_root]  (2.6.34, 2.6.35, 2.6.36)
CVE<span class="hljs-string">-2004</span><span class="hljs-string">-0077</span> [mremap_pte] (2.4.20, 2.2.24, 2.4.25, 2.4.26, 2.4.27)</code></pre><p><strong>已对外公开 exp 注：</strong></p><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/SecWiki/</span>linux-kernel-exploits
https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Kabot/</span>Unix-Privilege-Escalation-Exploits-Pack/
https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/xairy/</span>kernel-exploits</code></pre><hr><h4 id="6-1-1-2-Sudo漏洞分析-CVE-2019-14287"><a href="#6-1-1-2-Sudo漏洞分析-CVE-2019-14287" class="headerlink" title="6.1.1.2 Sudo漏洞分析 (CVE-2019-14287)"></a>6.1.1.2 Sudo漏洞分析 (CVE-2019-14287)</h4><pre><code class="hljs gradle">sudo -V | <span class="hljs-keyword">grep</span> <span class="hljs-string">&#x27;Sudo version&#x27;</span></code></pre><p>即可查看是否受到该版本（低于1.8.29）的影响</p><p>参考</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>www.sudo.ws<span class="hljs-regexp">/alerts/mi</span>nus_1_uid.html
https:<span class="hljs-regexp">//</span>www.sudo.ws<span class="hljs-regexp">/sudo/m</span>an<span class="hljs-regexp">/1.8.2/</span>sudoers.man.html
https:<span class="hljs-regexp">//</span>www.freebuf.com<span class="hljs-regexp">/vuls/</span><span class="hljs-number">217089</span>.html</code></pre><hr><h4 id="6-1-1-3-Linux提权之内核提权"><a href="#6-1-1-3-Linux提权之内核提权" class="headerlink" title="6.1.1.3 Linux提权之内核提权"></a>6.1.1.3 Linux提权之内核提权</h4><pre><code class="hljs applescript">anquanke.com/post/<span class="hljs-built_in">id</span>/<span class="hljs-number">98628</span>  <span class="hljs-comment">---详解Linux权限提升的攻击与防护</span></code></pre><p>这两篇文章写得非常好，仔细看完就懂了…</p><hr><h3 id="6-1-2-Windows"><a href="#6-1-2-Windows" class="headerlink" title="6.1.2 Windows"></a>6.1.2 Windows</h3><h4 id="6-1-2-1-windows提权-快速查找exp"><a href="#6-1-2-1-windows提权-快速查找exp" class="headerlink" title="6.1.2.1 windows提权-快速查找exp"></a>6.1.2.1 windows提权-快速查找exp</h4><p>微软官方时刻关注列表网址：</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>technet.microsoft.com<span class="hljs-regexp">/zh-cn/</span>library<span class="hljs-regexp">/security/</span>dn639106.aspx</code></pre><p>地址更新为：</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>docs.microsoft.com<span class="hljs-regexp">/zh-cn/</span>security-updates<span class="hljs-regexp">/securitybulletins/</span><span class="hljs-number">2017</span>/securitybulletins2017</code></pre><p>比如常用的几个已公布的 exp：</p><pre><code class="hljs dns">KB<span class="hljs-number">2592799</span>
KB<span class="hljs-number">3000061</span>
KB<span class="hljs-number">2592799</span>
...</code></pre><p>快速查找未打补丁的 exp，可以最安全的减少目标机的未知错误，以免影响业务。 命令行下执行检测未打补丁的命令如下：</p><pre><code class="hljs less"><span class="hljs-selector-tag">systeminfo</span>&gt;<span class="hljs-selector-tag">micropoor</span><span class="hljs-selector-class">.txt</span><span class="hljs-selector-tag">&amp;</span>(for %i in ( KB977165 KB2160329 KB2503665 KB2592799
KB2707511 KB2829361 KB2850851 KB3000061 KB3045171 KB3077657 KB3079904
KB3134228 KB3143141 KB3141780 ) do <span class="hljs-variable">@type</span> micropoor.txt|<span class="hljs-variable">@find</span> /i
<span class="hljs-string">&quot;%i&quot;</span>|| <span class="hljs-variable">@echo</span> %i you can fuck)<span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-tag">del</span> /<span class="hljs-selector-tag">f</span> /<span class="hljs-selector-tag">q</span> /<span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">micropoor</span><span class="hljs-selector-class">.txt</span></code></pre><p>注：以上需要在可写目录执行。需要临时生成micrpoor.txt，以上补丁编号请根据环境来增删</p><p><strong>exp注：</strong></p><pre><code class="hljs gradle">MS17-<span class="hljs-number">017</span> [KB4013081] [GDI Palette Objects Local Privilege Escalation] (windows <span class="hljs-number">7</span>/<span class="hljs-number">8</span>)
CVE-<span class="hljs-number">2017</span>-<span class="hljs-number">8464</span> [LNK Remote Code Execution Vulnerability] (windows <span class="hljs-number">10</span><span class="hljs-regexp">/8.1/</span><span class="hljs-number">7</span><span class="hljs-regexp">/2016/</span><span class="hljs-number">2010</span>/<span class="hljs-number">2008</span>）
CVE-<span class="hljs-number">2017</span>-<span class="hljs-number">0213</span> [Windows COM Elevation of Privilege Vulnerability] (windows <span class="hljs-number">10</span><span class="hljs-regexp">/8.1/</span><span class="hljs-number">7</span><span class="hljs-regexp">/2016/</span><span class="hljs-number">2010</span>/<span class="hljs-number">2008</span>)
MS17-<span class="hljs-number">010</span> [KB4013389] [Windows Kernel Mode Drivers](windows <span class="hljs-number">7</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">2003</span>/XP)
MS16-<span class="hljs-number">135</span> [KB3199135] [Windows Kernel Mode Drivers] (<span class="hljs-number">2016</span>)
MS16-<span class="hljs-number">111</span> [KB3186973] [kernel api] (Windows <span class="hljs-number">10</span> <span class="hljs-number">10586</span> (<span class="hljs-number">32</span><span class="hljs-regexp">/64)/</span><span class="hljs-number">8.1</span>)
MS16-<span class="hljs-number">098</span> [KB3178466] [Kernel Driver] (Win <span class="hljs-number">8.1</span>)
MS16-<span class="hljs-number">075</span> [KB3164038] [Hot Potato] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span><span class="hljs-regexp">/8/</span><span class="hljs-number">2012</span>)
MS16-<span class="hljs-number">034</span> [KB3143145] [Kernel Driver] (<span class="hljs-number">2008</span><span class="hljs-regexp">/7/</span><span class="hljs-number">8</span><span class="hljs-regexp">/10/</span><span class="hljs-number">2012</span>)
MS16-<span class="hljs-number">032</span> [KB3143141] [Secondary Logon Handle] (<span class="hljs-number">2008</span><span class="hljs-regexp">/7/</span><span class="hljs-number">8</span><span class="hljs-regexp">/10/</span><span class="hljs-number">2012</span>)
MS16-<span class="hljs-number">016</span> [KB3136041] [WebDAV] (<span class="hljs-number">2008</span><span class="hljs-regexp">/Vista/</span><span class="hljs-number">7</span>)
MS15-<span class="hljs-number">097</span> [KB3089656] [remote code execution] (win8.<span class="hljs-number">1</span>/<span class="hljs-number">2012</span>)
MS15-<span class="hljs-number">076</span> [KB3067505] [RPC] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span><span class="hljs-regexp">/8/</span><span class="hljs-number">2012</span>)
MS15-<span class="hljs-number">077</span> [KB3077657] [ATM] (XP<span class="hljs-regexp">/Vista/</span>Win7<span class="hljs-regexp">/Win8/</span><span class="hljs-number">2000</span><span class="hljs-regexp">/2003/</span><span class="hljs-number">2008</span>/<span class="hljs-number">2012</span>)
MS15-<span class="hljs-number">061</span> [KB3057839] [Kernel Driver] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span><span class="hljs-regexp">/8/</span><span class="hljs-number">2012</span>)
MS15-<span class="hljs-number">051</span> [KB3057191] [Windows Kernel Mode Drivers] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span><span class="hljs-regexp">/8/</span><span class="hljs-number">2012</span>)
MS15-<span class="hljs-number">010</span> [KB3036220] [Kernel Driver] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span>/<span class="hljs-number">8</span>)
MS15-<span class="hljs-number">015</span> [KB3031432] [Kernel Driver] (Win7<span class="hljs-regexp">/8/</span><span class="hljs-number">8.1</span><span class="hljs-regexp">/2012/</span>RT<span class="hljs-regexp">/2012 R2/</span><span class="hljs-number">2008</span> R2)
MS15-<span class="hljs-number">001</span> [KB3023266] [Kernel Driver] (<span class="hljs-number">2008</span><span class="hljs-regexp">/2012/</span><span class="hljs-number">7</span>/<span class="hljs-number">8</span>)
MS14-<span class="hljs-number">070</span> [KB2989935] [Kernel Driver] (<span class="hljs-number">2003</span>)
MS14-<span class="hljs-number">068</span> [KB3011780] [Domain Privilege Escalation] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">2012</span><span class="hljs-regexp">/7/</span><span class="hljs-number">8</span>)
MS14-<span class="hljs-number">058</span> [KB3000061] [Win32k.sys] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">2012</span><span class="hljs-regexp">/7/</span><span class="hljs-number">8</span>)
MS14-<span class="hljs-number">040</span> [KB2975684] [AFD Driver] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">2012</span><span class="hljs-regexp">/7/</span><span class="hljs-number">8</span>)
MS14-<span class="hljs-number">002</span> [KB2914368] [NDProxy] (<span class="hljs-number">2003</span>/XP)
MS13-<span class="hljs-number">053</span> [KB2850851] [win32k.sys] (XP<span class="hljs-regexp">/Vista/</span><span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span>win <span class="hljs-number">7</span>)
MS13-<span class="hljs-number">046</span> [KB2840221] [dxgkrnl.sys] (Vista<span class="hljs-regexp">/2003/</span><span class="hljs-number">2008</span><span class="hljs-regexp">/2012/</span><span class="hljs-number">7</span>)
MS13-<span class="hljs-number">005</span> [KB2778930] [Kernel Mode Driver] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">2012</span><span class="hljs-regexp">/win7/</span><span class="hljs-number">8</span>)
MS12-<span class="hljs-number">042</span> [KB2972621] [Service Bus] (<span class="hljs-number">2008</span><span class="hljs-regexp">/2012/</span>win7)
MS12-<span class="hljs-number">020</span> [KB2671387] [RDP] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span>/XP)
MS11-<span class="hljs-number">080</span> [KB2592799] [AFD.sys] (<span class="hljs-number">2003</span>/XP)
MS11-<span class="hljs-number">062</span> [KB2566454] [NDISTAPI] (<span class="hljs-number">2003</span>/XP)
MS11-<span class="hljs-number">046</span> [KB2503665] [AFD.sys] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span>/XP)
MS11-<span class="hljs-number">011</span> [KB2393802] [kernel Driver] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span><span class="hljs-regexp">/XP/</span>Vista)
MS10-<span class="hljs-number">092</span> [KB2305420] [<span class="hljs-keyword">Task</span> Scheduler] (<span class="hljs-number">2008</span>/<span class="hljs-number">7</span>)
MS10-<span class="hljs-number">065</span> [KB2267960] [FastCGI] (IIS <span class="hljs-number">5.1</span>, <span class="hljs-number">6.0</span>, <span class="hljs-number">7.0</span>, and <span class="hljs-number">7.5</span>)
MS10-<span class="hljs-number">059</span> [KB982799] [ACL-Churraskito] (<span class="hljs-number">2008</span><span class="hljs-regexp">/7/</span>Vista)
MS10-<span class="hljs-number">048</span> [KB2160329] [win32k.sys] (XP SP2 &amp; SP3<span class="hljs-regexp">/2003 SP2/</span>Vista SP1 &amp; SP2<span class="hljs-regexp">/2008 Gold &amp; SP2 &amp; R2/</span>Win7)
MS10-<span class="hljs-number">015</span> [KB977165] [KiTrap0D] (<span class="hljs-number">2003</span><span class="hljs-regexp">/2008/</span><span class="hljs-number">7</span>/XP)
MS10-<span class="hljs-number">012</span> [KB971468] [SMB Client Trans2 stack overflow] (Windows <span class="hljs-number">7</span>/<span class="hljs-number">2008</span>R2)
MS09-<span class="hljs-number">050</span> [KB975517][Remote Code Execution] (<span class="hljs-number">2008</span>/Vista)
MS09-<span class="hljs-number">020</span> [KB970483] [IIS <span class="hljs-number">6.0</span>] (IIS <span class="hljs-number">5.1</span> and <span class="hljs-number">6.0</span>)
MS09-<span class="hljs-number">012</span> [KB959454] [Chimichurri] (Vista<span class="hljs-regexp">/win7/</span><span class="hljs-number">2008</span>/Vista)
MS08-<span class="hljs-number">068</span> [KB957097] [Remote Code Execution] (<span class="hljs-number">2000</span>/XP)
MS08-<span class="hljs-number">067</span> [KB958644] [Remote Code Execution] (Windows <span class="hljs-number">2000</span><span class="hljs-regexp">/XP/</span>Server <span class="hljs-number">2003</span><span class="hljs-regexp">/Vista/</span>Server <span class="hljs-number">2008</span>)
MS08-<span class="hljs-number">066</span> [] [] (Windows <span class="hljs-number">2000</span><span class="hljs-regexp">/XP/</span>Server <span class="hljs-number">2003</span>)
MS08-<span class="hljs-number">025</span> [KB941693] [Win32.sys] (XP<span class="hljs-regexp">/2003/</span><span class="hljs-number">2008</span>/Vista)
MS06-<span class="hljs-number">040</span> [KB921883] [Remote Code Execution] (<span class="hljs-number">2003</span><span class="hljs-regexp">/xp/</span><span class="hljs-number">2000</span>)
MS05-<span class="hljs-number">039</span> [KB899588] [PnP Service] (Win <span class="hljs-number">9</span>X<span class="hljs-regexp">/ME/</span>NT<span class="hljs-regexp">/2000/</span>XP/<span class="hljs-number">2003</span>)
MS03-<span class="hljs-number">026</span> [KB823980] [Buffer Overrun In RPC <span class="hljs-keyword">Interface</span>] (<span class="hljs-regexp">/NT/</span><span class="hljs-number">2000</span><span class="hljs-regexp">/XP/</span><span class="hljs-number">2003</span>)</code></pre><p><strong>已对外公开exp注：</strong></p><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/SecWiki/</span>windows-kernel-exploits
https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/WindowsExploits/</span>Exploits
https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/AusJock/</span>Privilege-Escalation</code></pre><hr><h4 id="6-1-2-2-Token窃取与利用"><a href="#6-1-2-2-Token窃取与利用" class="headerlink" title="6.1.2.2 Token窃取与利用"></a>6.1.2.2 Token窃取与利用</h4><pre><code class="hljs asciidoc">https://3gstudent.github.io/3gstudent.github.io/渗透技巧-Token窃取与利用/
https://www.xianfish.xyz/2020/01/04/Token窃取与利用/
<span class="hljs-link">https://edu.heibai.org/Micro8-渗透沉思录/第一百一十课：窃取,伪造模拟各种windows访问令牌</span>[<span class="hljs-string">token利用</span>].pdf
<span class="hljs-link">https://gogs.coooool.club/jee/MICRO/src/573628d1dd817622347dfab242af55bdebfd586b/第一百一十课：窃取,伪造模拟各种windows访问令牌</span>[<span class="hljs-string">token利用</span>].pdf</code></pre><p>看完这四个文章，在复现下期中的一些原理，就摸透了Token窃取与利用！！！</p><hr><h4 id="6-1-2-3-CVE2019-1388-Windows-UAC-提权漏洞"><a href="#6-1-2-3-CVE2019-1388-Windows-UAC-提权漏洞" class="headerlink" title="6.1.2.3 CVE2019-1388 Windows UAC 提权漏洞"></a>6.1.2.3 CVE2019-1388 Windows UAC 提权漏洞</h4><p><strong>参考链接：</strong></p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>www.ajsafe.com<span class="hljs-regexp">/news/</span><span class="hljs-number">58</span>.html
http:<span class="hljs-regexp">//</span>blog.leanote.com<span class="hljs-regexp">/post/</span>snowming/<span class="hljs-number">38069</span>f423c76
https:<span class="hljs-regexp">//</span>portal.msrc.microsoft.com<span class="hljs-regexp">/en-US/</span>security-guidance<span class="hljs-regexp">/advisory/</span>CVE-<span class="hljs-number">2019</span>-<span class="hljs-number">1388</span></code></pre><hr><h4 id="6-1-3-第三方组件提权"><a href="#6-1-3-第三方组件提权" class="headerlink" title="6.1.3 第三方组件提权"></a>6.1.3 第三方组件提权</h4><p>权限提升参考总文章：</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>www.secpulse.com<span class="hljs-regexp">/archives/</span><span class="hljs-number">138197</span>.html</code></pre></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E7%BA%A2%E9%98%9F%E6%94%BB%E9%98%B2/">红队攻防</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/%E7%BA%A2%E9%98%9F%E6%94%BB%E9%98%B2/">红队攻防</a> <a class="hover-with-bg" href="/tags/%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB%E7%BA%A2%E9%98%9F%E7%99%BE%E7%A7%91%E5%85%A8%E4%B9%A6/">渗透攻击红队百科全书</a></div></div><p class="note note-warning"><strong>本文作者: </strong><a href="/">iceH</a><br><strong>本文链接: </strong><a href="http://www.secice.cn/p/ad5b2fbd.html">http://www.secice.cn/p/ad5b2fbd.html</a><br><strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext row"><article class="post-prev col-6"><a href="/p/efc8f01a.html"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">红队攻防学习之权限维持</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/p/56572a0f.html"><span class="hidden-mobile">红队攻防学习之内部信息收集</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments"><div id="vcomments"></div><script type="text/javascript">Fluid.utils.waitElementVisible("vcomments",(function(){Fluid.utils.createScript("https://cdn.staticfile.org/valine/1.4.14/Valine.min.js",(function(){new Valine({el:"#vcomments",app_id:"MnjV8raNBztIVGGKiicFL3Sq-MdYXbMMI",app_key:"hS70MmgmzDqbMSkSAfkDe42h",placeholder:"留下你的小脚印吧...",path:window.location.pathname,avatar:"wavatar",meta:["nick","mail"],pageSize:"10",lang:"zh-CN",highlight:!1,recordIP:!1,serverURLs:""})}))}))</script><noscript>Please enable JavaScript to view the <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments powered by Valine.</a></noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><div class="col-lg-7 mx-auto nopadding-md"><div class="container custom post-custom mx-auto"><img src="/img/psb.gif" srcset="/img/loading.gif" class="rounded mx-auto d-block mt-5" style="width:300px;height:150px"></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><span>iceH</span> <i class="iconfont icon-love"></i> <span>一条啥也不会的咸鱼！</span></div></footer><script src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:200}),NProgress.start(),document.addEventListener("DOMContentLoaded",(function(){window.NProgress&&window.NProgress.inc()})),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js"></script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js"></script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/js/local-search.js"></script><script>document.querySelector("#local-search-input").onclick=function(){searchFunc("/local-search.xml","local-search-input","local-search-result"),this.onclick=null}</script><script src="/js/qipao.js"></script><script src="/js/jingtaisidai.js"></script><script src="/js/dianjichuzi.js"></script><script src="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="//cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="/js/boot.js"></script></body></html>